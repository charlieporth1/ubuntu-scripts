#!/bin/bash
sysctl -w net.ipv6.conf.all.forwarding=1
sysctl -w net.ipv4.ip_forward=1

function iface_restart() {
	local iface="$1"
        sudo ip link set $iface up
        sudo ip link set $iface down
        sudo ip addr flush $iface
        sudo ip link set $iface up
	sudo dhclient -r
	sudo dhclient
}

iface=wlan0
if ! ifconfig | grep -o $iface > /dev/null
then
	iface_restart $iface
fi

iface=eth0
if ! ifconfig | grep -o $iface > /dev/null
then
	iface_restart $iface
	sudo ifconfig $iface 192.168.44.250 up
fi




if ! ping -c 3 -w 10 192.168.44.1 > /dev/null
then
	iface_restart eth0
	sudo systemctl restart networking
	sudo ifconfig $iface 192.168.44.250 up

elif ! ping -c 3 -w 10 1.1.1.1 > /dev/null
then
	iface_restart eth0
	sudo ifconfig $iface 192.168.44.250 up

elif ! ping -c 3 -w 10 192.168.44.249 > /dev/null
then
	iface_restart eth0
	sudo ifconfig $iface 192.168.44.250 up
fi

sudo ifconfig $iface 192.168.44.250 up



